<!-- https://stackoverflow.com/questions/47010949/basic-multiple-file-upload-not-working-on-mobile/47061673
 -->
<!DOCTYPE html>
<html lang="en">

<head>
  <title>Easy host</title>
  <link rel="icon" type="image/png" href="icon.png">
  <meta charset="UTF-8">
  <meta name="description" content="host free file(s) and websites any apply analytics over it">
  <meta name="keywords"
    content="Easy to upload, Easy to share, Easy to track!!
  (host file get sharing link over mail and get access to dashboard to get result of visits over 50+ client machine related parameters)">
  <meta name="author" content="Harshit Mahajan">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href='https://fonts.googleapis.com/css?family=Asul' rel='stylesheet'>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <script src="javascripts/jszip.min.js"></script>
  <link href="https://fonts.googleapis.com/css?family=Vollkorn+SC" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="funnytext.css" />
  <script type="text/javascript" src="funnytext.js"></script>
  <style type="text/css">
    .file-well,
    .file-well input {
      position: absolute;
      cursor: pointer;
      left: 0px;
      top: 0px;
      width: 600px;
      height: 300px;
      position: absolute;
      border-radius: 20px;
      font-family: Arial;
      text-align: center;
      position: relative;
      line-height: 180px;
      font-size: 20px;
      color: rgba(0, 0, 0, .3);
    }

    .file-well {
      width: 600px;
      height: 300px;
      position: absolute;
      left: 50%;
      top: 5px;
      margin-left: -290px;
      border-radius: 20px;
      font-family: Arial;
      text-align: center;
      position: relative;
      line-height: 180px;
      font-size: 20px;
      color: rgba(0, 0, 0, .3);
      background-image: url("/cc.png");
    }

    tr {
      text-align: "left";
    }

    #form {
      position: absolute;
      top: 350px;
      left: 0px;
    }

    .file-well.filled {
      background-color: blue;
    }

    .file-well input {
      opacity: 0.01;
    }

    #conte,
    #infoo {
      color: rgba(255, 255, 255, 1);
    }

    #infoo {
      font-family: 'Asul';
      font-size: 20px;
    }

    body {
      background-image: url("/sky.jpg");
      font-size: 150%;
      font-family: 'Vollkorn SC', serif;
    }

    h4 {
      color: black;
    }

    #conte {
      font-size: 200%;
    }

    h1 {
      font-size: 200%;
    }
  </style>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-101489450-2"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-101489450-2');
  </script>

</head>

<body align="center" class="container" class="jumbotron">
  <div id="conte">
    <h1 class="mySelector">Easy host</h1>
    <p>Easy to upload, Easy to share, Easy to Analyze!!</p>
  </div>
  <label for="file-upload" class="custom-file-upload">
    <i class="fa fa-cloud-upload"></i>
  </label>
  <div class="file-well">
    <input id="file-upload" type="file" required name="uploads[]" multiple="multiple" />
  </div>
  <br>
  <span id="infoo">
    Drag File(s) / website in cloud above to host
    <br>
    or
    <br>
    <br>
    <button type="button" id="track_own_web" class="btn btn-primary btn-lg" onclick="jQuery.noConflict();
$('#custom').modal('show');">Track your own website with Easyhost</button>
  </span>
  <div class="container">
    <div class="modal fade" id="myModa" role="dialog">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal">&times;</button>
            <h4 class="modal-title">upload -> Share -> Track </h4>
          </div>
          <div class="modal-body">
            <table class="table" id="filetable">
              <thead>
                <tr align="right">
                  <th align="right">Filename</th>
                  <th>size (in KB)</th>
                </tr>
              </thead>
              <tbody id="fileinfo" align="left">
              </tbody>
            </table>
            <hr>
            <input type="hidden" id="filesize" name="filesize" />
            <input type="hidden" id="lastupdate" name="filelastupdate" />
            <input type="checkbox" id="isSecret" name="isSecret" value="isSecret">
            <p id="isSecretChkBox">Secure by
              password</p>
            <input id="secret" value="" name="secret" type="hidden" class="form-control"
              placeholder="Set file share password">
            <label id="secretValidator"></label><br>
            <label title="show/hide password" style="display: none;" onmouseover="showPassword()"
              onmouseout="showPassword()" id="eye">üëÅ</label></br></br>


            <input type='button' class="btn btn-primary" id="uploadBtn" value="upload"></input><br>
            <br>
            <div class="progress">
              <div class="progress-bar" role="progressbar"></div>
            </div>
            <span id="totalsize"></span>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div>

      </div>
    </div>
    <div class="modal fade" id="custom" role="dialog">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal">&times;</button>
            <h4 class="modal-title">Get credentials </h4>
          </div>
          <div class="modal-body">
            <br>
            <input type='button' class="btn btn-primary" id="genCredBtn" value="Generate credentials"></input> <br><span
              id="custominfo"><span>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script type="text/javascript">


    $("#isSecret").click(function () {
      if ($('#isSecret').is(':checked')) {
        $('#secret').attr('type', "password");
        $('#eye').show()
        $("#secret").val("")
      } else {
        $('#secret').attr('type', "hidden");
        $('#eye').hide()
        $("#secret").val("")
      }
    });

    $("#isSecretChkBox").click(function () {
      if ($('#isSecret').is(':checked')) {
        $('#isSecret').prop('checked', false);
        $('#secret').attr('type', "hidden");
        $('#eye').hide()
        $("#secret").val("")
      } else {
        $('#secret').attr('type', "password");
        $('#eye').show()
        $("#secret").val("")
        $('#isSecret').prop('checked', true);
      }
    });


    function showPassword() {
      var x = document.getElementById("secret");
      if (x.type === "password") {
        x.type = "text";
      } else {
        x.type = "password";
      }
    }
    $("#track_own_web").click(function () {
      $("#genCredBtn").show()
      $("#custominfo").html('')

    })
    $("#genCredBtn").click(function () {
      document.getElementById("custominfo").innerHTML = "Please wait...";
      $.post("/issuecredentials", { visiterId: localStorage.getItem('visitId') }, function (result) {
        $("#custominfo").html("Script Tag to inclide in webpage :</br><pre>" +
          result.split('+')[1] +
          "</pre> </br>" +
          "Dashboard link : </br><pre>" +
          result.split('+')[0] + "</pre><br>" + "Delete:</br><pre>" + result.split('+')[0].replace("table", "delete") + "</pre><br>" + "<h6>*Tracking will only work over https</h6>"
        );
      });
      $("#genCredBtn").hide()
    });

    $(document).ready(function () {
      var table = document.getElementById("fileinfo");
      $('#file-upload').on('change', function (evt) {
        $("#fileinfo tr>td").remove();
        var files = $("#file-upload").get(0).files;
        var total_size = 0;
        if (files.length > 0) {
          for (var i = 0; i < files.length; i++) {
            total_size = total_size + files[i].size;
            var row = table.insertRow(i);
            var cell1 = row.insertCell(0);
            var cell2 = row.insertCell(1);
            cell1.innerHTML = files[i].name;
            cell2.innerHTML = parseFloat(files[i].size / 1024).toFixed(2);
          }
        }
        $('#totalsize').text("Total size : " + parseFloat(total_size / 1024).toFixed(2) + " KB")
        var fileSize = this.files[0].size / 1024 / 1024;
        $('#filesize').val(fileSize)
        $('#lastupdate').val(this.files[0].lastModified)
        $('.filename').html(this.files[0].name)
        jQuery.noConflict();
        // $('#secret').attr('type', "hidden");
        // $('#eye').hide()
        // $("#secret").val("")
        $('#isSecret').prop('checked', false);
        $("#uploadBtn").show()
        $('.progress-bar').html('');
        $('.progress-bar').text(0 + '%');
        $('.progress-bar').width(0 + '%');

        // if (percentComplete === 100) {
        //   $("#uploadBtn").hide()
        //   $('.progress-bar').html('Done');
        // }


        $('#myModa').modal('show');
      });
    });
    $(document).ready(function () {
      $('.mySelector').funnyText({
        speed: 700,
        borderColor: 'black',
        activeColor: 'white',
        color: 'black',
        fontSize: '7em',
        direction: 'both'
      });
      function saveTextAsFile(content, filename) {
        var textToWrite = content;
        var textFileAsBlob = new Blob([textToWrite], { type: 'application/octet-stream' });
        var fileNameToSaveAs = filename;
        var downloadLink = document.createElement("a");
        downloadLink.download = fileNameToSaveAs;
        downloadLink.innerHTML = "Download File";
        if (window.webkitURL != null) {
          downloadLink.href = window.webkitURL.createObjectURL(textFileAsBlob);
        }
        else {
          downloadLink.href = window.URL.createObjectURL(textFileAsBlob);
          downloadLink.onclick = destroyClickedElement;
          downloadLink.style.display = "none";
          document.body.appendChild(downloadLink);
        }
        downloadLink.click();
      }
      $('#uploadBtn').on('click', function (evt) {
        $('.progress-bar').hide()
        $('#secretValidator').html("")
        $('#isSecret').prop('checked', false);

        if (($('#isSecret').is(':checked')) && ($('#secret').val().length < 6)) {
          $('#secretValidator').html("secret must contain atleast 6 chracters")
        }
        else {
          $('#secretValidator').html("")
          $('#totalsize').text("Please wait...")
          var zip = new JSZip();
          var files = $("#file-upload").get(0).files;
          var total_size = 0;
          if (files.length > 0) {
            for (var i = 0; i < files.length; i++) {
              total_size = total_size + files[i].size;
              var file = files[i];
              zip.file(file.name, files[i]);
            }
            if (total_size <= 5242880) {
              zip.generateAsync({ type: "blob" })
                .then(function (con) {
                  var formData = new FormData();
                  // if (files.length == 1 && files[0].name.split(".")[1] == "zip") {
                  //   formData.append('uploads[]', files[0], files[0].name);
                  // }
                  // else {
                  formData.append('uploads[]', con, "filename.zip");
                  // }
                  if ($('#isSecret').val()) {
                    formData.append('secret', $("#secret").val())
                  }
                  formData.append('visiterId', localStorage.getItem('visitId'))
                  $.ajax({
                    url: '/uploadfile',
                    type: 'POST',
                    data: formData,
                    processData: false,
                    contentType: false,
                    success: function (data) {
                      //alert(data)
                      $('#totalsize').html("Public link to share : </br><pre>" + data.split('+')[0] + "</pre></br>Private Dashboard link : </br><pre>" + data.split('+')[1] + "</pre></br>Delete uploaded data using:</br><pre>" + data.split('+')[2] + "</pre>")
                    },
                    xhr: function (data) {
                      $('.progress-bar').show()
                      var xhr = new XMLHttpRequest();
                      xhr.upload.addEventListener('progress', function (evt) {
                        if (evt.lengthComputable) {
                          var percentComplete = evt.loaded / evt.total;
                          percentComplete = parseInt(percentComplete * 100);
                          $('.progress-bar').text(percentComplete + '%');
                          $('.progress-bar').width(percentComplete + '%');
                          if (percentComplete === 100) {
                            $("#uploadBtn").hide()
                            $('.progress-bar').html('Done');
                          }
                        }
                      }, false);
                      return xhr;
                    },
                    error: function (data) {
                      $('#totalsize').text(data.responseText)
                    }
                  });
                });
            } else {
              $('#totalsize').text("File size limit exceed,select file of size <=5 MB");
            }
          }
        }
      });
    });


  </script>
  <script src="commancript.js"></script> -->
  <script type="text/javascript">
    if (userdata.Mobile) {
      alert("For better user experience use desktop!!")
    }
  </script>


</body>

</html>